## 1.2 Routing Concepts

### 1.2.a Administrative distance

| Connected      | AD  |
|----------------|-----|
| Connected      | 0   |
| Static         | 1   |
| EIGRP          | 90  |
| EIGRP Summary  | 5   |
| Eigrp External | 170 |
| OSPFv2         | 110 |
| OSPFv3         | 110 |
| eBGP           | 20  |
| iBGP           | 200 |
| RIPv2          | 120 |

### 1.2.b VRF-lite

* VRFs without MPLS 

### 1.2.c Static routing
### 1.2.d Policy Based Routing
### 1.2.e VRF aware routing with any routing protocol

* EIGRP 
  * IPv4 
  * IPv6 
* OSPFv2 
* OSPFv3 
  * IPv4
  * IPv6 
* BGP 
  * IPv4 
  * IPv6 

### 1.2.f Route filtering with any routing protocol

* EIGRP 
  * IPv4 
  * IPv6 
* OSPFv2 
* OSPFv3 
  * IPv4
  * IPv6 
* BGP 
  * IPv4 
  * IPv6 

### 1.2.g Manual summarization with any routing protocol

* EIGRP 
  * IPv4 
  * IPv6 
* OSPFv2 
* OSPFv3 
  * IPv4
  * IPv6 
* BGP 
  * IPv4 
  * IPv6 

### 1.2.h Redistribution between any pair of routing protocols

* Remember, the routes you want to redistirbute must be in the FIB from the routing protocol you're redistributing from. 
  * E.g., if you learn a route from OSPF and EIGRP, you will only redistirbute it if you're redistributing from EIGRP
* Route tag to avoid continual redistirbution 
* Use route-maps for control 
* When redistributing between two protocols on the same device and the route originates from that device in another protocol (e.g., redistribute EIGRP 100 to EIGRP 200, but redistribute a Connected route), the target protocol will konw where that route originally came from (in previous example, `show ip eigrp topology` will show the route sourced from Connected, even though you are redistributing EIGRP 100, not Connected). 
* From OSPFv2 to ANY protocol: 
  * No IPV6 support in OSPFv2
  * Make sure to use the match option appropriately. By default, without match, IOS will only redistribute internal routes (intra- and inter-area routes)
  * Match options: 
  	* internal
  	* external 1
  	* external 2 
  	* nssa-external 1
  	* nssa-external 2
* IPv6 Specials 
  * include-connected: 
   * For IPv4 address families, connected interfaces that are running the routing process are redistributed into the other process. 
   * IPv6 does not do this by default, either use include-connected or redist conn separately 


* EIGRP 
  * When redistributing into EIGRP, you need to deal with metric, one of two ways:
    1. Set the metric on redistribution, `redist PROTOCOL [#] metric <bandwidth> <delay> <reliability> <load> <mtu>` 
    2. Set the default metric, `default-metric <bandwidth> <delay> <reliability> <load> <mtu>`
  * As always, use route-maps to be safe when redistributing
  * From Static to EIGRP
    * Configure (new style): 
    ```
    router eigrp CCIE
    !
    address-family ipv4 unicast autonomous-system 100
     !
     topology base
      redistribute static metric 15000 0 255 1 1500 [ route-map ]
     exit-af-topology
    exit-address-family
    !        
    address-family ipv6 unicast autonomous-system 100
     !
     topology base
      redistribute static metric 15000 0 255 1 1500 [ route-map ]
     exit-af-topology
    exit-address-family
    ```
    * Configure (old style - only shown once, from here on out, using new style CLI): 
    ```
    router eigrp 100
     default-metric 10000 0 255 1 1500
     redistribute static [ route-map ]
    ipv6 router eigrp 100
     redistribute static [ route-map ]
     default-metric 10000 0 255 1 1500
    ```
    * Verify: 
      * `sh ip ei topo`
      * `sh ip route`
  * From Connected to EIGRP
    * Configure: 
    ```
    router eigrp CCIE
    !
    address-family ipv4 unicast autonomous-system 100
     !
     topology base
      redistribute connected metric 15000 0 255 1 1500 [ route-map ]
     exit-af-topology
    exit-address-family
    !        
    address-family ipv6 unicast autonomous-system 100
     !
     topology base
      redistribute connected metric 15000 0 255 1 1500 [ route-map ] 
     exit-af-topology
    exit-address-family
    ```
    * Verify:   
      * `sh ip ei topo`
      * `sh ip route`    
  * From EIGRP to EIGRP
    * Configure: 
    ```
    router eigrp CCIE
    !
    address-family ipv4 unicast autonomous-system 100
     !
     topology base
      redistribute eigrp 200 [ route-map ]
     exit-af-topology
    exit-address-family
    !        
    address-family ipv6 unicast autonomous-system 100
     !
     topology base
      redistribute eigrp 200 [ route-map ] 
     exit-af-topology
    exit-address-family
    ```    
    * Verify: 
      * `sh ip ei topo`
      * `sh ip route`  
  * From OSPFv2 and OSPFv3 to EIGRP
    * Configure: 
    ```
    router eigrp CCIE
    !
    address-family ipv4 unicast autonomous-system 100
     !
     topology base
      redistribute ospf 100 metric 15000 0 255 1 1500 [ match ] [ route-map ]
     exit-af-topology
    exit-address-family
    !        
    address-family ipv6 unicast autonomous-system 100
     !
     topology base
      redistribute ospfv3 101 metric 15000 0 255 1 1500 [ include-connected] [ match ] [ route-map ]
     exit-af-topology
    exit-address-family
    ```
    * Verify: 
      * `sh ip ei topo`
      * `sh ip route`    
  * From BGP to EIGRP
    * Configure: 
    ```
    router eigrp CCIE
    !
    address-family ipv4 unicast autonomous-system 100
     !
     topology base
      redistribute bgp 65101 metric 15000 0 255 1 1500 [ route-map ]
     exit-af-topology
    exit-address-family
    !        
    address-family ipv6 unicast autonomous-system 100
     !
     topology base
      redistribute bgp 65101 metric 15000 0 255 1 1500 [ route-map ] 
     exit-af-topology
    exit-address-family
    ```
    * Verify: 
      * `sh ip ei topo`
      * `sh ip route`
  * From RIPv2 to EIGRP
    * Configure: 
    ```
    router eigrp CCIE
    !
    address-family ipv4 unicast autonomous-system 100
     !
     topology base
      redistribute rip metric 15000 0 255 1 1500 [ route-map ]
     exit-af-topology
    exit-address-family
    !        
    address-family ipv6 unicast autonomous-system 100
     !
     topology base
      redistribute rip metric 15000 0 255 1 1500 [ route-map ] 
     exit-af-topology
    exit-address-family
    ```
    * Verify: 
      * `sh ip ei topo`
      * `sh ip route`
* OSPFv2 
  * When you redistribute into OSPF, the redistributing router becomes and ASBR 
  * Subnet keyword - if you don't use the subnets keyword when redistributing, only classful networks are redistributed 
    * You almost always want this. 
  * Other options: 
    * route-map 
    * metric - default is 20, set from 0-16777214 
    * metric-type 
      1. 1 - E1/N1 routes are preferred over E2/N2 routes. Their cost is the cost of the external metric + internal cost with OSPF to reach that network. 
      2. 2 - E2/N2 routes cost is just the external metric, ignores internal.
    * nssa-only 
      * Per Cisco, "The nssa-only keyword instructs the device to instigate Type-7 LSA with cleared P-bit, thereby, preventing LSA translation to Type 5 on NSSA ABR device."
      * The P-bit is a loop-prevention mechanism. P = propagate 
        * The P-bit tells the ABR if the Type 7 LSA should be translated into a Type 5 into area 0. Only LSAs with P-bit set will be translated to type-5. 
      * Setting this option means the route will only be kept within the NSSA and not sent out to the rest of the OSPF routing domain 
    * Tag - tag the route as it goes into OSPF. This tag does get passed to other routers. 
  * From Static to OSPFv2
    * Configure:
    ```
    router ospf 100
     router-id 10.255.255.12
     auto-cost reference-bandwidth 10000
     redistribute static subnets [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ]
     
    ```
    * Verify: 
      * `show ip ospf database external`
  * From Connected to OSPFv2
    * Configure:
    ```
    router ospf 100
     redistribute connected subnets [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ]
    ```
    * Verify: 
      * `show ip ospf database external`
  * From EIGRP to OSPFv2
   * Configure:
    ```
    router ospf 100
     redistribute eigrp 100 subnets [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ]
    ```
    * Verify: 
      * `show ip ospf database external`
  * From OSPFv2 to OSPFv2
   * Configure:
   ```
   router ospf 100
    redistribute ospf 200 subnets [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]
   ```
    * Verify: 
      * `show ip ospf database external`
  * From OSPFv3 to OSPFv2
    * Configure:
    ```
    router ospf 100
     redistribute ospf 101 subnets [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ] [ vrf ]
     ```
    * Verify: 
      * `show ip ospf database external`
  * From BGP to OSPFv2
    * Configure:
    ```
    router ospf 100
     redistribute bgp 65101 subnets [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]     
    ```
    * Verify: 
      * `show ip ospf database external`
  * From RIPv2 to OSPFv2
    * Configure:
    ```
    router ospf 100
     redistribute rip subnets [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]     
    ```
    * Verify: 
      * `show ip ospf database external`  
* OSPFv3 
  * Thankfully, it's all classless and the stupid `subnets` keyword is not in OSPFv3. 
  * From Static to OSPFv3
  ```
  router ospfv3 101
   !
   address-family ipv4 unicast
    redistribute static [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]     
   exit-address-family
   !
   address-family ipv6 unicast
    redistribute static [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]      
   exit-address-family
  ```    
  * From Connected to OSPFv3
  ```
  router ospfv3 101
   !
   address-family ipv4 unicast
    redistribute connected [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]     
   exit-address-family
   !
   address-family ipv6 unicast
    redistribute connected [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]      
   exit-address-family
  ```    
  * From EIGRP to OSPFv3
  ```
  router ospfv3 101
   !
   address-family ipv4 unicast
    redistribute eigrp 100 [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]     
   exit-address-family
   !
   address-family ipv6 unicast
    redistribute eigrp 100 [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ] [ include-connected ]     
   exit-address-family
  ```    
  * From OSPFv2 to OSPFv3
  ```
  router ospfv3 101
   !
   address-family ipv4 unicast
    redistribute ospf 100 [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ] [ vrf ]     
   exit-address-family
  ```    
  * From OSPFv3 to OSPFv3
  ```
  router ospfv3 101
   !
   address-family ipv4 unicast
    redistribute ospf 102 [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]     
   exit-address-family
   !
   address-family ipv6 unicast
    redistribute ospf 102 [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ] [ include-connected ]     
   exit-address-family
  ```    
  * From BGP to OSPFv3
  * Configure: 
  ```
  router ospfv3 101
   !
   address-family ipv4 unicast
    redistribute bgp 65101 [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ] [ vrf ]
   exit-address-family
   !
   address-family ipv6 unicast
    redistribute bgp 65101 [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ] [ vrf ]    
   exit-address-family
  ```
  * Verify: 
    * `show ospfv3 database ext`
  * From RIPv2 to OSPFv3
  ```
  router ospfv3 101
   !
   address-family ipv4 unicast
    redistribute rip [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ]     
   exit-address-family
   !
   address-family ipv6 unicast
    redistribute rip [ metric ] [ metric-type ] [ nssa-only ] [ route-map ] [ tag ] [ match ( e 1 e 2 n 1 n 2 int ) ] [ include-connected ]     
   exit-address-family
  ```  
* BGP 
  * From Connected to BGP
      * Set all your, metric or local pref
      * `redist conn` with no route-map just redistributes everything 
      * Redistributed routes show up with first AS path of `?`
      * Configure:   
       
        ```
        ip prefix-list PL-ANY seq 5 permit 0.0.0.0/0 le 32
        ipv6 prefix-list PL6-ANY seq 5 permit ::/0 le 128
       
        route-map RM-CONN->BGP permit 10 
         match ip address prefix-list PL-ANY
         set metric 300
        route-map RM6-CONN->BGP permit 10 
         match ipv6 address prefix-list PL6-ANY
         set local-preference 150
       
        router bgp 65101
         address-family ipv4 unicast 
          redistribute connected route-map RM-BGP->CONN
         address-family ipv4 unicast 
          redistribute connected route-map RM6-BGP->CONN
        ```
      * Verify: 
        * `show bgp ipv4 unicast`
        * `show bgp ipv6 unicast`    
  * From Static to BGP
      * Configure:
        ``` 
        router bgp 65101
         address-family ipv4 unicast 
          redistribute static [ route-map NAME ]
         address-family ipv4 unicast 
          redistribute static [ route-map NAME ]
        ```        
    * Verify: 
      * `show bgp ipv4 unicast`
      * `show bgp ipv6 unicast`    
  * From EIGRP to BGP
    * BGP keeps the IGP metric as its metric in the BGP tables and transmits this to peers 
      * Remember, metric = MED 
    * Configure:
        ``` 
        router bgp 65101
         address-family ipv4 unicast 
          redistribute eigrp 100 [ route-map NAME ]
         address-family ipv4 unicast 
          redistribute eigrp 100 [ route-map NAME | include-connected ]
        ```        
    * Verify: 
      * `show bgp ipv4 unicast`
      * `show bgp ipv6 unicast`    
  
  * From OSPFv2 to BGP
    * Configure: 
      ```
      router bgp 65101 
       address-family ipv4 unicast
         redistribute ospf 100 [ match ] [ route-map]
      ```
    * Verify: 
      * `show bgp ipv4 uni`
      * `show bgp ipv6 uni`
  * From OSPFv3 to BGP
    * Configure:
    ```
    router bgp 65101 
       address-family ipv4 unicast
         redistribute ospfv3 101 [ match ] [ route-map ]
       address-family ipv6 unicast
         redistribute ospf 101 [ include-connected] [ match ] [ route-map ] 
    ```
  * From BGP to BGP
    * Unlike other protocols, you can only run one instance of BGP per router 
    * For multi-VRF BGP, use vpnv4 address families (even without MPLS) to have different BGP process in different VRFs 
    * Use local-as to show up as a different AS to your neighbor other than your BGP process
    * If you need routes from one BGP VPN AF to another, use route-leaking 
  * From RIPv2 to BGP
    * Hopefully you never have to do this 
    ```
    router bgp 65101
     address-family ipv4 uni 
      redistribute rip [ route-map ]
     address-family ipv6 uni
      redistribute rip PROCESSNAME [ route-map | include-connected ]
    ```
* RIPv2 
  * From Static to RIPv2
  * From Connected to RIPv2
  * From EIGRP to RIPv2
  * From OSPFv2 to RIPv2
  * From OSPFv3 to RIPv2
  * From BGP to RIPv2
  * From RIPv2 to RIPv2



### 1.2.i Routing protocol authentication

* EIGRP 
* OSPF 
* BGP 

### 1.2.j Bidirectional Forwarding Detection
